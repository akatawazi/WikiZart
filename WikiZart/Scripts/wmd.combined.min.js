(function(){WMDEditor=function(c){this.options=WMDEditor.util.extend({},WMDEditor.defaults,c||{});H(this,this.options);this.startEditor()};window.WMDEditor=WMDEditor;WMDEditor.defaults={version:2,output_format:"markdown",lineLength:40,button_bar:"wmd-button-bar",preview:"wmd-preview",output:"wmd-output",input:"wmd-input",imageDialogText:"<p style='margin-top: 0px'><b>Enter the image URL.</b></p><p>You can also add a title, which will be displayed as a tool tip.</p><p>Example:<br />http://wmd-editor.com/images/cloud1.jpg   \"Optional title\"</p>",
linkDialogText:"<p style='margin-top: 0px'><b>Enter the web address.</b></p><p>You can also add a title, which will be displayed as a tool tip.</p><p>Example:<br />http://wmd-editor.com/   \"Optional title\"</p>",imageDefaultText:"http://",linkDefaultText:"http://",imageDirectory:"images/",helpLink:"http://wmd-editor.com/",helpHoverTitle:"WMD website",helpTarget:"_blank",previewPollInterval:500,pastePollInterval:100,buttons:"bold italic link blockquote code image ol ul heading hr",tagFilter:{enabled:true,
allowedTags:/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,patternLink:/^(<a\shref="(\#\d+|(https?|ftp):\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+)"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,patternImage:/^(<img\ssrc="https?:(\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+)"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i}};WMDEditor.prototype={getPanels:function(){return{buttonBar:typeof this.options.button_bar==
"string"?document.getElementById(this.options.button_bar):this.options.button_bar,preview:typeof this.options.preview=="string"?document.getElementById(this.options.preview):this.options.preview,output:typeof this.options.output=="string"?document.getElementById(this.options.output):this.options.output,input:typeof this.options.input=="string"?document.getElementById(this.options.input):this.options.input}},startEditor:function(){this.panels=this.getPanels();this.previewMgr=new I(this);edit=new this.editor(this.previewMgr.refresh);
this.previewMgr.refresh(true)}};var t={isVisible:function(c){return c.offsetWidth>0||c.offsetHeight>0},addEvent:function(c,j,h){c.attachEvent?c.attachEvent("on"+j,h):c.addEventListener(j,h,false)},removeEvent:function(c,j,h){c.detachEvent?c.detachEvent("on"+j,h):c.removeEventListener(j,h,false)},fixEolChars:function(c){c=c.replace(/\r\n/g,"\n");return c=c.replace(/\r/g,"\n")},extendRegExp:function(c,j,h){if(j===null||j===undefined)j="";if(h===null||h===undefined)h="";c=c.toString();var d="";d=c.match(/\/([gim]*)$/);
d=d===null?d[0]:"";c=c.replace(/(^\/|\/[gim]*$)/g,"");c=j+c+h;return RegExp(c,d)},createImage:function(c){c=imageDirectory+c;var j=document.createElement("img");j.className="wmd-button";j.src=c;return j},prompt:function(c,j,h){var d,a,g;if(j===undefined)j="";var n=function(q){(q.charCode||q.keyCode)===27&&k(true)},k=function(q){t.removeEvent(document.body,"keydown",n);var r=g.value;if(q)r=null;else{r=r.replace("http://http://","http://");r=r.replace("http://https://","https://");r=r.replace("http://ftp://",
"ftp://")}d.parentNode.removeChild(d);a.parentNode.removeChild(a);h(r);return false},m=function(){d=document.createElement("div");d.className="wmd-prompt-dialog";d.style.padding="10px;";d.style.position="fixed";d.style.width="400px";d.style.zIndex="10001";var q=document.createElement("div");q.innerHTML=c;q.style.padding="5px";d.appendChild(q);q=document.createElement("form");q.onsubmit=function(){return k(false)};style=q.style;style.padding="0";style.margin="0";style.cssFloat="left";style.width="100%";
style.textAlign="center";style.position="relative";d.appendChild(q);g=document.createElement("input");g.type="text";g.value=j;style=g.style;style.display="block";style.width="80%";style.marginLeft=style.marginRight="auto";q.appendChild(g);var r=document.createElement("input");r.type="button";r.onclick=function(){return k(false)};r.value="OK";style=r.style;style.margin="10px";style.display="inline";style.width="7em";var u=document.createElement("input");u.type="button";u.onclick=function(){return k(true)};
u.value="Cancel";style=u.style;style.margin="10px";style.display="inline";style.width="7em";if(/mac/.test(B.platform.toLowerCase())){q.appendChild(u);q.appendChild(r)}else{q.appendChild(r);q.appendChild(u)}t.addEvent(document.body,"keydown",n);d.style.top="50%";d.style.left="50%";d.style.display="block";if(A.isIE_5or6){d.style.position="absolute";d.style.top=document.documentElement.scrollTop+200+"px";d.style.left="50%"}document.body.appendChild(d);d.style.marginTop=-(C.getHeight(d)/2)+"px";d.style.marginLeft=
-(C.getWidth(d)/2)+"px"};(function(){a=document.createElement("div");a.className="wmd-prompt-background";style=a.style;style.position="absolute";style.top="0";style.zIndex="10000";if(A.isKonqueror)style.backgroundColor="transparent";else if(A.isIE)style.filter="alpha(opacity=50)";else style.opacity="0.5";var q=C.getPageSize();style.height=q[1]+"px";if(A.isIE){style.left=document.documentElement.scrollLeft;style.width=document.documentElement.clientWidth}else{style.left="0";style.width="100%"}document.body.appendChild(a)})();
window.setTimeout(function(){m();var q=j.length;if(g.selectionStart!==undefined){g.selectionStart=0;g.selectionEnd=q}else if(g.createTextRange){var r=g.createTextRange();r.collapse(false);r.moveStart("character",-q);r.moveEnd("character",q);r.select()}g.focus()},0)},extend:function(){function c(d,a){for(var g in a)d[g]=a[g];return d}for(var j={},h=0;h<arguments.length;h++)c(j,arguments[h]);return j}},C={getTop:function(c,j){var h=c.offsetTop;if(!j)for(;c=c.offsetParent;)h+=c.offsetTop;return h},getHeight:function(c){return c.offsetHeight||
c.scrollHeight},getWidth:function(c){return c.offsetWidth||c.scrollWidth},getPageSize:function(){var c,j,h,d;if(self.innerHeight&&self.scrollMaxY){c=document.body.scrollWidth;j=self.innerHeight+self.scrollMaxY}else if(document.body.scrollHeight>document.body.offsetHeight){c=document.body.scrollWidth;j=document.body.scrollHeight}else{c=document.body.offsetWidth;j=document.body.offsetHeight}if(self.innerHeight){h=self.innerWidth;d=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){h=
document.documentElement.clientWidth;d=document.documentElement.clientHeight}else if(document.body){h=document.body.clientWidth;d=document.body.clientHeight}return[Math.max(c,h),Math.max(j,d),h,d]}},D=function(c,j){var h=this;this.init=function(){if(t.isVisible(c)){this.setInputAreaSelectionStartEnd();this.scrollTop=c.scrollTop;if(!this.text&&c.selectionStart||c.selectionStart===0)this.text=c.value}};this.setInputAreaSelection=function(){if(t.isVisible(c))if(c.selectionStart!==undefined&&!A.isOpera){c.focus();
c.selectionStart=h.start;c.selectionEnd=h.end;c.scrollTop=h.scrollTop}else if(document.selection)if(!(typeof document.activeElement!="unknown"&&document.activeElement&&document.activeElement!==c)){c.focus();var d=c.createTextRange();d.moveStart("character",-c.value.length);d.moveEnd("character",-c.value.length);d.moveEnd("character",h.end);d.moveStart("character",h.start);d.select()}};this.setInputAreaSelectionStartEnd=function(){if(c.selectionStart||c.selectionStart===0){h.start=c.selectionStart;
h.end=c.selectionEnd}else if(document.selection){h.text=t.fixEolChars(c.value);var d;if(j.ieRetardedClick&&j.ieCachedRange){d=j.ieCachedRange;j.ieRetardedClick=false}else d=document.selection.createRange();var a=t.fixEolChars(d.text),g="\u0007"+a+"\u0007";d.text=g;var n=t.fixEolChars(c.value);d.moveStart("character",-g.length);d.text=a;h.start=n.indexOf("\u0007");h.end=n.lastIndexOf("\u0007")-1;if(g=h.text.length-t.fixEolChars(c.value).length){for(d.moveStart("character",-a.length);g--;){a+="\n";
h.end+=1}d.text=a}this.setInputAreaSelection()}};this.restore=function(){if(h.text!=undefined&&h.text!=c.value)c.value=h.text;this.setInputAreaSelection();c.scrollTop=h.scrollTop};this.getChunks=function(){var d=new E;d.before=t.fixEolChars(h.text.substring(0,h.start));d.startTag="";d.selection=t.fixEolChars(h.text.substring(h.start,h.end));d.endTag="";d.after=t.fixEolChars(h.text.substring(h.end));d.scrollTop=h.scrollTop;return d};this.setChunks=function(d){d.before+=d.startTag;d.after=d.endTag+
d.after;if(A.isOpera){d.before=d.before.replace(/\n/g,"\r\n");d.selection=d.selection.replace(/\n/g,"\r\n");d.after=d.after.replace(/\n/g,"\r\n")}this.start=d.before.length;this.end=d.before.length+d.selection.length;this.text=d.before+d.selection+d.after;this.scrollTop=d.scrollTop};this.init()},E=function(){};E.prototype.findTags=function(c,j){var h=this,d;if(c){d=t.extendRegExp(c,"","$");this.before=this.before.replace(d,function(a){h.startTag+=a;return""});d=t.extendRegExp(c,"^","");this.selection=
this.selection.replace(d,function(a){h.startTag+=a;return""})}if(j){d=t.extendRegExp(j,"","$");this.selection=this.selection.replace(d,function(a){h.endTag=a+h.endTag;return""});d=t.extendRegExp(j,"^","");this.after=this.after.replace(d,function(a){h.endTag=a+h.endTag;return""})}};E.prototype.trimWhitespace=function(c){this.selection=this.selection.replace(/^(\s*)/,"");c||(this.before+=z.$1);this.selection=this.selection.replace(/(\s*)$/,"");if(!c)this.after=z.$1+this.after};E.prototype.addBlankLines=
function(c,j,h){if(c===undefined)c=1;if(j===undefined)j=1;c++;j++;var d,a;d=/(^\n*)/.exec(this.selection);this.selection=this.selection.replace(/(^\n*)/,"");this.startTag+=d?d[1]:"";d=/(\n*$)/.exec(this.selection);this.selection=this.selection.replace(/(\n*$)/,"");this.endTag+=d?d[1]:"";d=/(^\n*)/.exec(this.startTag);this.startTag=this.startTag.replace(/(^\n*)/,"");this.before+=d?d[1]:"";d=/(\n*$)/.exec(this.endTag);this.endTag=this.endTag.replace(/(\n*$)/,"");this.after+=d?d[1]:"";if(this.before){for(d=
a="";c--;){d+="\\n?";a+="\n"}if(h)d="\\n*";this.before=this.before.replace(new z(d+"$",""),a)}if(this.after){for(d=a="";j--;){d+="\\n?";a+="\n"}if(h)d="\\n*";this.after=this.after.replace(new z(d,""),a)}};var J=function(c,j,h){var d=this,a,g,n,k;this.tick=function(){if(t.isVisible(c)){if(c.selectionStart||c.selectionStart===0){var m=c.selectionStart,q=c.selectionEnd;if(m!=a||q!=g){a=m;g=q;if(n!=c.value){n=c.value;return true}}}return false}};this.destroy=function(){window.clearInterval(k)};k=window.setInterval(function(){t.isVisible(c)&&
d.tick()&&j()},h)},I=function(c){var j=this,h,d,a,g,n,k,m="delayed",q=function(){var i=0;if(window.innerHeight)i=window.pageYOffset;else if(document.documentElement&&document.documentElement.scrollTop)i=document.documentElement.scrollTop;else if(document.body)i=document.body.scrollTop;return i},r=function(){if(c.panels.preview||c.panels.output){var i=c.panels.input.value;if(!(i&&i==n)){n=i;var v=(new Date).getTime();if(!h&&c.showdown)h=new c.showdown.converter;if(h)i=h.makeHtml(i);g=(new Date).getTime()-
v;x(i);k=i}}},u=function(){if(a){window.clearTimeout(a);a=undefined}if(m!=="manual"){var i=0;if(m==="delayed")i=g;if(i>3E3)i=3E3;a=window.setTimeout(r,i)}},s=function(i){if(i.scrollHeight<=i.clientHeight)return 1;return i.scrollTop/(i.scrollHeight-i.clientHeight)};this.refresh=function(i){if(i){n="";r()}else u()};this.processingTime=function(){return g};this.output=function(){return k};this.setUpdateMode=function(i){m=i;j.refresh()};var o=true,x=function(i){var v=C.getTop(c.panels.input)-q();if(c.panels.output)if(c.panels.output.value!==
undefined)c.panels.output.value=i;else{var b=i.replace(/&/g,"&amp;");b=b.replace(/</g,"&lt;");c.panels.output.innerHTML="<pre><code>"+b+"</code></pre>"}if(c.panels.preview){if(c.options.tagFilter.enabled)i=i.replace(/<[^<>]*>?/gi,function(f){return f.match(c.options.tagFilter.allowedTags)||f.match(c.options.tagFilter.patternLink)||f.match(c.options.tagFilter.patternImage)?f:""});c.panels.preview.innerHTML=i}if(c.panels.preview)c.panels.preview.scrollTop=(c.panels.preview.scrollHeight-c.panels.preview.clientHeight)*
s(c.panels.preview);if(c.panels.output)c.panels.output.scrollTop=(c.panels.output.scrollHeight-c.panels.output.clientHeight)*s(c.panels.output);if(o)o=false;else{var e=C.getTop(c.panels.input)-q();A.isIE?window.setTimeout(function(){window.scrollBy(0,e-v)},0):window.scrollBy(0,e-v)}};this.destroy=function(){d&&d.destroy()};(function(i,v){t.addEvent(i,"input",v);i.onpaste=v;i.ondrop=v;t.addEvent(i,"keypress",v);t.addEvent(i,"keydown",v);d=new J(c.panels.input,v,c.options.previewPollInterval)})(c.panels.input,
u);r();if(c.panels.preview)c.panels.preview.scrollTop=0;if(c.panels.output)c.panels.output.scrollTop=0},F=function(c,j,h,d){var a=this,g=[],n=0,k="none",m,q,r,u,s=function(b,e){if(k!=b){k=b;e||x()}if(!A.isIE||k!="moving")r=window.setTimeout(o,1);else u=null},o=function(){u=new D(j,c);q.tick();r=undefined};this.setCommandMode=function(){k="command";x();r=window.setTimeout(o,0)};this.canUndo=function(){return n>1};this.canRedo=function(){if(g[n+1])return true;return false};this.undo=function(){if(a.canUndo())if(m){m.restore();
m=null}else{g[n]=new D(j,c);g[--n].restore();d&&d()}k="none";j.focus();o()};this.redo=function(){if(a.canRedo()){g[++n].restore();d&&d()}k="none";j.focus();o()};var x=function(){var b=u||new D(j,c);if(!b)return false;if(k=="moving")m||(m=b);else{if(m){if(g[n-1].text!=m.text)g[n++]=m;m=null}g[n++]=b;g[n+1]=null;d&&d()}},i=function(b){var e=false;if(b.ctrlKey||b.metaKey)switch(String.fromCharCode(b.charCode||b.keyCode)){case "y":a.redo();e=true;break;case "z":b.shiftKey?a.redo():a.undo();e=true}if(e){b.preventDefault&&
b.preventDefault();if(window.event)window.event.returnValue=false}},v=function(b){if(!b.ctrlKey&&!b.metaKey){b=b.keyCode;if(b>=33&&b<=40||b>=63232&&b<=63235)s("moving");else if(b==8||b==46||b==127)s("deleting");else if(b==13)s("newlines");else if(b==27)s("escape");else if((b<16||b>20)&&b!=91)s("typing")}};this.destroy=function(){q&&q.destroy()};(function(){t.addEvent(j,"keypress",function(e){if((e.ctrlKey||e.metaKey)&&(e.keyCode==89||e.keyCode==90))e.preventDefault()});var b=function(){if(A.isIE||
u&&u.text!=j.value)if(r==undefined){k="paste";x();o()}};q=new J(j,b,h);t.addEvent(j,"keydown",i);t.addEvent(j,"keydown",v);t.addEvent(j,"mousedown",function(){s("moving")});j.onpaste=b;j.ondrop=b})();o();x()};WMDEditor.util=t;WMDEditor.position=C;WMDEditor.TextareaState=D;WMDEditor.InputPoller=J;WMDEditor.PreviewManager=I;WMDEditor.UndoManager=F;var z=window.RegExp,B=window.navigator,A=function(){var c={};c.isIE=/msie/.test(B.userAgent.toLowerCase());c.isIE_5or6=/msie 6/.test(B.userAgent.toLowerCase())||
/msie 5/.test(B.userAgent.toLowerCase());c.isIE_7plus=c.isIE&&!c.isIE_5or6;c.isOpera=/opera/.test(B.userAgent.toLowerCase());c.isKonqueror=/konqueror/.test(B.userAgent.toLowerCase());return c}(),H=function(c,j){c.Command={};c.Global={};c.buttons={};c.showdown=window.Showdown;var h=WMDEditor.util,d=c.Command;c.ieCachedRange=null;c.ieRetardedClick=false;c.editor=function(a){a||(a=function(){});var g=c.panels.input,n=this,k,m=function(s){g.focus();if(s.textOp){k&&k.setCommandMode();var o=new D(c.panels.input,
c);if(!o)return;var x=o.getChunks(),i=function(){g.focus();x&&o.setChunks(x);o.restore();a()};s.textOp(x,i,true)||i()}s.execute&&s.execute(n)},q=function(){if(k){r(c.buttons["wmd-undo-button"],k.canUndo());r(c.buttons["wmd-redo-button"],k.canRedo())}},r=function(s,o){if(o){s.style.backgroundPosition=s.XShift+" 0px";s.onmouseover=function(){this.style.backgroundPosition=this.XShift+" -40px"};s.onmouseout=function(){this.style.backgroundPosition=this.XShift+" 0px"};if(A.isIE)s.onmousedown=function(){c.ieRetardedClick=
true;c.ieCachedRange=document.selection.createRange()};if(!s.isHelp)s.onclick=function(){this.onmouseout&&this.onmouseout();m(this);return false}}else{s.style.backgroundPosition=s.XShift+" -20px";s.onmouseover=s.onmouseout=s.onclick=function(){}}},u=function(){function s(f,l,p){var w=document.createElement("li");c.buttons[f]=w;w.className="wmd-button "+f;w.XShift=b+"px";b-=20;if(l)w.title=l;if(p)w.textOp=p;return w}function o(f,l,p){f=s(f,l,p);r(f,true);v.appendChild(f);return f}function x(f){var l=
document.createElement("li");l.className="wmd-spacer "+f;v.appendChild(l);return l}var i=typeof j.button_bar=="string"?document.getElementById(j.button_bar||"wmd-button-bar"):j.button_bar,v=document.createElement("ul");v.className="wmd-button-row";v=i.appendChild(v);var b=0;o("wmd-bold-button","Strong <strong> Ctrl+B",d.doBold);o("wmd-italic-button","Emphasis <em> Ctrl+I",d.doItalic);x("wmd-spacer1");o("wmd-link-button","Hyperlink <a> Ctrl+L",function(f,l){return d.doLinkOrImage(f,l,false)});o("wmd-quote-button",
"Blockquote <blockquote> Ctrl+Q",d.doBlockquote);o("wmd-code-button","Code Sample <pre><code> Ctrl+K",d.doCode);o("wmd-image-button","Image <img> Ctrl+G",function(f,l){return d.doLinkOrImage(f,l,true)});x("wmd-spacer2");o("wmd-olist-button","Numbered List <ol> Ctrl+O",function(f,l,p){d.doList(f,l,true,p)});o("wmd-ulist-button","Bulleted List <ul> Ctrl+U",function(f,l,p){d.doList(f,l,false,p)});o("wmd-heading-button","Heading <h1>/<h2> Ctrl+H",d.doHeading);o("wmd-hr-button","Horizontal Rule <hr> Ctrl+R",
d.doHorizontalRule);x("wmd-spacer3");o("wmd-undo-button","Undo - Ctrl+Z").execute=function(f){f.undo()};i=o("wmd-redo-button","Redo - Ctrl+Y");i.title=/win/.test(B.platform.toLowerCase())?"Redo - Ctrl+Y":"Redo - Ctrl+Shift+Z";i.execute=function(f){f.redo()};i=s("wmd-help-button");i.isHelp=true;r(i,true);v.appendChild(i);var e=document.createElement("a");e.href=j.helpLink;e.target=j.helpTarget;e.title=j.helpHoverTitle;i.appendChild(e);q()};this.undo=function(){k&&k.undo()};this.redo=function(){k&&
k.redo()};this.destroy=function(){k&&k.destroy();(void 0).parentNode&&(void 0).parentNode.removeChild(void 0);if(g)g.style.marginTop="";window.clearInterval(void 0)};(function(){if(/\?noundo/.test(document.location.href))c.nativeUndo=true;c.nativeUndo||(k=new F(c,c.panels.input,c.options.pastePollInterval,function(){a();q()}));u();var s="keydown";if(A.isOpera)s="keypress";h.addEvent(g,s,function(o){if(o.ctrlKey||o.metaKey){switch(String.fromCharCode(o.charCode||o.keyCode).toLowerCase()){case "b":m(c.buttons["wmd-bold-button"]);
break;case "i":m(c.buttons["wmd-italic-button"]);break;case "l":m(c.buttons["wmd-link-button"]);break;case "q":m(c.buttons["wmd-quote-button"]);break;case "k":m(c.buttons["wmd-code-button"]);break;case "g":m(c.buttons["wmd-image-button"]);break;case "o":m(c.buttons["wmd-olist-button"]);break;case "u":m(c.buttons["wmd-ulist-button"]);break;case "h":m(c.buttons["wmd-heading-button"]);break;case "r":m(c.buttons["wmd-hr-button"]);break;case "y":m(c.buttons["wmd-redo-button"]);break;case "z":o.shiftKey?
m(c.buttons["wmd-redo-button"]):m(c.buttons["wmd-undo-button"]);break;default:return}o.preventDefault&&o.preventDefault();if(window.event)window.event.returnValue=false}});h.addEvent(g,"keyup",function(o){if(!o.shiftKey&&!o.ctrlKey&&!o.metaKey)if((o.charCode||o.keyCode)===13){fakeButton={};fakeButton.textOp=d.doAutoindent;m(fakeButton)}});A.isIE&&h.addEvent(g,"keydown",function(o){if(o.keyCode===27)return false})})()};d.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)";
d.unwrap=function(a){var g=new z("([^\\n])\\n(?!(\\n|"+d.prefixes+"))","g");a.selection=a.selection.replace(g,"$1 $2")};d.wrap=function(a,g){d.unwrap(a);var n=new z("(.{1,"+g+"})( +|$\\n?)","gm");a.selection=a.selection.replace(n,function(k,m){if((new z("^"+d.prefixes,"")).test(k))return k;return m+"\n"});a.selection=a.selection.replace(/\s+$/,"")};d.doBold=function(a){return d.doBorI(a,2,"strong text")};d.doItalic=function(a){return d.doBorI(a,1,"emphasized text")};d.doBorI=function(a,g,n){a.trimWhitespace();
a.selection=a.selection.replace(/\n{2,}/g,"\n");a.before.search(/(\**$)/);var k=z.$1;a.after.search(/(^\**)/);var m=z.$1;k=Math.min(k.length,m.length);if(k>=g&&(k!=2||g!=1)){a.before=a.before.replace(z("[*]{"+g+"}$",""),"");a.after=a.after.replace(z("^[*]{"+g+"}",""),"")}else if(!a.selection&&m){a.after=a.after.replace(/^([*_]*)/,"");a.before=a.before.replace(/(\s?)$/,"");a.before=a.before+m+z.$1}else{if(!a.selection&&!m)a.selection=n;g=g<=1?"*":"**";a.before+=g;a.after=g+a.after}};d.stripLinkDefs=
function(a,g){return a=a.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(n,k,m,q,r){g[k]=n.replace(/\s*$/,"");if(q){g[k]=n.replace(/["(](.+?)[")]$/,"");return q+r}return""})};d.addLinkDef=function(a,g){var n=0,k={};a.before=d.stripLinkDefs(a.before,k);a.selection=d.stripLinkDefs(a.selection,k);a.after=d.stripLinkDefs(a.after,k);var m="",q=/(\[(?:\[[^\]]*\]|[^\[\]])*\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,r=function(o){n++;o=o.replace(/^[ ]{0,3}\[(\d+)\]:/,
"  ["+n+"]:");m+="\n"+o},u=function(o,x,i,v){if(k[i]){r(k[i]);return x+n+v}return o};a.before=a.before.replace(q,u);if(g)r(g);else a.selection=a.selection.replace(q,u);var s=n;a.after=a.after.replace(q,u);if(a.after)a.after=a.after.replace(/\n*$/,"");if(!a.after)a.selection=a.selection.replace(/\n*$/,"");a.after+="\n\n"+m;return s};d.doLinkOrImage=function(a,g,n){a.trimWhitespace();a.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);if(a.endTag.length>1){a.startTag=a.startTag.replace(/!?\[/,"");a.endTag=
"";d.addLinkDef(a,null)}else if(/\n\n/.test(a.selection))d.addLinkDef(a,null);else{var k=function(m){if(m!==null){a.startTag=a.endTag="";m=d.addLinkDef(a," [999]: "+m);a.startTag=n?"![":"[";a.endTag="]["+m+"]";if(!a.selection)a.selection=n?"alt text":"link text"}g()};n?h.prompt(j.imageDialogText,j.imageDefaultText,k):h.prompt(j.linkDialogText,j.linkDefaultText,k);return true}};d.doAutoindent=function(a,g,n){a.before=a.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n");a.before=a.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,
"\n\n");a.before=a.before.replace(/(\n|^)[ \t]+\n$/,"\n\n");n=false;/(\n|^)[ ]{0,3}([*+-])[ \t]+.*\n$/.test(a.before)&&d.doList&&d.doList(a,g,false,true);/(\n|^)[ ]{0,3}(\d+[.])[ \t]+.*\n$/.test(a.before)&&d.doList&&d.doList(a,g,true,true);/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(a.before)&&d.doBlockquote&&d.doBlockquote(a,g,n);/(\n|^)(\t|[ ]{4,}).*\n$/.test(a.before)&&d.doCode&&d.doCode(a,g,n)};d.doBlockquote=function(a,g,n){a.selection=a.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(k,m,q,r){a.before+=
m;a.after=r+a.after;return q});a.before=a.before.replace(/(>[ \t]*)$/,function(k,m){a.selection=m+a.selection;return""});g=n?"Blockquote":"";a.selection=a.selection.replace(/^(\s|>)+$/,"");a.selection=a.selection||g;if(a.before)a.before=a.before.replace(/\n?$/,"\n");if(a.after)a.after=a.after.replace(/^\n?/,"\n");a.before=a.before.replace(/(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*$)/,function(k){a.startTag=k;return""});a.after=a.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(k){a.endTag=
k;return""});g=function(k){var m=k?"> ":"";if(a.startTag)a.startTag=a.startTag.replace(/\n((>|\s)*)\n$/,function(q,r){return"\n"+r.replace(/^[ ]{0,3}>?[ \t]*$/gm,m)+"\n"});if(a.endTag)a.endTag=a.endTag.replace(/^\n((>|\s)*)\n/,function(q,r){return"\n"+r.replace(/^[ ]{0,3}>?[ \t]*$/gm,m)+"\n"})};if(/^(?![ ]{0,3}>)/m.test(a.selection)){d.wrap(a,j.lineLength-2);a.selection=a.selection.replace(/^/gm,"> ");g(true);a.addBlankLines()}else{a.selection=a.selection.replace(/^[ ]{0,3}> ?/gm,"");d.unwrap(a);
g(false);if(!/^(\n|^)[ ]{0,3}>/.test(a.selection)&&a.startTag)a.startTag=a.startTag.replace(/\n{0,2}$/,"\n\n");if(!/(\n|^)[ ]{0,3}>.*$/.test(a.selection)&&a.endTag)a.endTag=a.endTag.replace(/^\n{0,2}/,"\n\n")}if(!/\n/.test(a.selection))a.selection=a.selection.replace(/^(> *)/,function(k,m){a.startTag+=m;return""})};d.doCode=function(a,g,n){g=/\S[ ]*$/.test(a.before);if(!/^[ ]*\S/.test(a.after)&&!g||/\n/.test(a.selection)){a.before=a.before.replace(/[ ]{4}$/,function(m){a.selection=m+a.selection;return""});
var k=g=1;if(/\n(\t|[ ]{4,}).*\n$/.test(a.before)||a.after==="")g=0;if(/^\n(\t|[ ]{4,})/.test(a.after))k=0;a.addBlankLines(g,k);if(a.selection)a.selection=/^[ ]{0,3}\S/m.test(a.selection)?a.selection.replace(/^/gm,"    "):a.selection.replace(/^[ ]{4}/gm,"");else{a.startTag="    ";a.selection=n?"enter code here":""}}else{a.trimWhitespace();a.findTags(/`/,/`/);if(!a.startTag&&!a.endTag){a.startTag=a.endTag="`";if(!a.selection)a.selection=n?"enter code here":""}else if(a.endTag&&!a.startTag){a.before+=
a.endTag;a.endTag=""}else a.startTag=a.endTag=""}};d.doList=function(a,g,n,k){g=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/;var m="-",q=1,r=function(){var i;if(n){i=" "+q+". ";q++}else i=" "+m+" ";return i},u=function(i){if(n===undefined)n=/^\s*\d/.test(i);return i=i.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(){return r()})};a.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null);if(a.before&&!/\n$/.test(a.before)&&!/^\n/.test(a.startTag)){a.before+=
a.startTag;a.startTag=""}if(a.startTag){var s=/\d+[.]/.test(a.startTag);a.startTag="";a.selection=a.selection.replace(/\n[ ]{4}/g,"\n");d.unwrap(a);a.addBlankLines();if(s)a.after=a.after.replace(g,u);if(n==s)return}var o=1;a.before=a.before.replace(/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,function(i){if(/^\s*([*+-])/.test(i))m=z.$1;o=/[^\n]\n\n[^\n]/.test(i)?1:0;return u(i)});if(!a.selection)a.selection=k?"List item":" ";k=r();var x=1;a.after=
a.after.replace(g,function(i){x=/[^\n]\n\n[^\n]/.test(i)?1:0;return u(i)});a.trimWhitespace(true);a.addBlankLines(o,x,true);a.startTag=k;k=k.replace(/./g," ");d.wrap(a,j.lineLength-k.length);a.selection=a.selection.replace(/\n/g,"\n"+k)};d.doHeading=function(a){a.selection=a.selection.replace(/\s+/g," ");a.selection=a.selection.replace(/(^\s+|\s+$)/g,"");if(a.selection){var g=0;a.findTags(/#+[ ]*/,/[ ]*#+/);if(/#+/.test(a.startTag))g=z.lastMatch.length;a.startTag=a.endTag="";a.findTags(null,/\s?(-+|=+)/);
if(/=+/.test(a.endTag))g=1;if(/-+/.test(a.endTag))g=2;a.startTag=a.endTag="";a.addBlankLines(1,1);g=g==0?2:g-1;if(g>0){g=g>=2?"-":"=";var n=a.selection.length;if(n>j.lineLength)n=j.lineLength;for(a.endTag="\n";n--;)a.endTag+=g}}else{a.startTag="## ";a.selection="Heading";a.endTag=" ##"}};d.doHorizontalRule=function(a){a.startTag="----------\n";a.selection="";a.addBlankLines(2,1,true)}}})();function setup_wmd(t){return new WMDEditor(t)}var Showdown={};
Showdown.converter=function(){var t,C,D,E=0;this.makeHtml=function(b){t=[];C=[];D=[];b=b.replace(/~/g,"~T");b=b.replace(/\$/g,"~D");b=b.replace(/\r\n/g,"\n");b=b.replace(/\r/g,"\n");b="\n\n"+b+"\n\n";b=x(b);b=b.replace(/^[ \t]+$/mg,"");b=I(b);b=J(b);b=z(b);b=s(b);b=b.replace(/~D/g,"$$");b=b.replace(/~T/g,"~");b=b.replace(/https?\:\/\/[^"\s\<\>]*[^.,;'">\:\s\<\>\)\]\!]/g,function(e,f){var l=b.slice(0,f),p=b.slice(f);if(l.match(/<[^>]+$/)&&p.match(/^[^>]*>/))return e;return"<a href='"+e+"'>"+e+"</a>"});
return b=b.replace(/[a-z0-9_\-+=.]+@[a-z0-9\-]+(\.[a-z0-9-]+)+/ig,function(e){return"<a href='mailto:"+e+"'>"+e+"</a>"})};var J=function(b){return b=b.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|\Z)/gm,function(e,f,l,p,w){f=f.toLowerCase();t[f]=q(l);if(p)return p+w;else if(w)C[f]=w.replace(/"/g,"&quot;");return""})},I=function(b){b=b.replace(/\n/g,"\n\n");b=b.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,
F);b=b.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,F);b=b.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,F);b=b.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,F);b=b.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,F);return b=b.replace(/\n\n/g,"\n")},F=function(b,e){var f=e;f=f.replace(/\n\n/g,"\n");f=f.replace(/^\n/,"");f=f.replace(/\n+$/g,"");return f="\n\n~K"+
(D.push(f)-1)+"K\n\n"},z=function(b){b=j(b);var e=g("<hr />");b=b.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,e);b=b.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,e);b=b.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,e);b=d(b);b=a(b);b=m(b);b=b=I(b);b=b.replace(/^\n+/g,"");b=b.replace(/\n+$/g,"");var f=b.split(/\n{2,}/g);b=[];e=f.length;for(var l=0;l<e;l++){var p=f[l];if(p.search(/~K(\d+)K/g)>=0)b.push(p);else if(p.search(/\S/)>=0){p=B(p);p=p.replace(/\n/g,"<br />");p=p.replace(/^([ \t]*)/g,"<p>");
p+="</p>";b.push(p)}}e=b.length;for(l=0;l<e;l++)for(;b[l].search(/~K(\d+)K/)>=0;){f=D[RegExp.$1];f=f.replace(/\$/g,"$$$$");b[l]=b[l].replace(/~K\d+K/,f)}return b=b.join("\n\n")},B=function(b){b=n(b);b=b=A(b);b=b.replace(/\\(\\)/g,v);b=b=b=b.replace(/\\([`*_{}\[\]()>#+-.!])/g,v);b=b.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,c);b=b=b=b.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,c);b=b.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,
H);b=b.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,H);b=b=b.replace(/(\[([^\[\]]+)\])()()()()()/g,H);b=r(b);b=b=q(b);b=b.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>");b=b.replace(/(\w)_(\w)/g,"$1~E95E$2");b=b=b.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");return b=b.replace(/  +\n/g," <br />\n")},A=function(b){return b=b.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi,function(e){e=e.replace(/(.)<\/?code>(?=.)/g,
"$1`");return e=i(e,"\\`*_")})},H=function(b,e,f,l,p,w,G,y){if(y==undefined)y="";b=l.toLowerCase();p=p;y=y;if(p==""){if(b=="")b=f.toLowerCase().replace(/ ?\n/g," ");if(t[b]!=undefined){p=t[b];if(C[b]!=undefined)y=C[b]}else if(e.search(/\(\s*\)$/m)>-1)p="";else return e}p=i(p,"*_");e='<a href="'+p+'"';if(y!=""){y=y.replace(/"/g,"&quot;");y=i(y,"*_");e+=' title="'+y+'"'}e+=">"+f+"</a>";return e},c=function(b,e,f,l,p,w,G,y){b=f;l=l.toLowerCase();p=p;(y=y)||(y="");if(p==""){if(l=="")l=b.toLowerCase().replace(/ ?\n/g,
" ");if(t[l]!=undefined){p=t[l];if(C[l]!=undefined)y=C[l]}else return e}b=b.replace(/"/g,"&quot;");p=i(p,"*_");e='<img src="'+p+'" alt="'+b+'"';y=y.replace(/"/g,"&quot;");y=i(y,"*_");e+=' title="'+y+'"';e+=" />";return e},j=function(b){b=b.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,f){return g("<h1>"+B(f)+"</h1>")});b=b.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,f){return g("<h2>"+B(f)+"</h2>")});return b=b.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,f,l){e=f.length;return g("<h"+
e+">"+B(l)+"</h"+e+">")})},h,d=function(b){b+="~0";var e=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;if(E)b=b.replace(e,function(f,l,p){f=l;p=p.search(/[*+-]/g)>-1?"ul":"ol";f=f.replace(/\n{2,}/g,"\n\n\n");f=h(f);f=f.replace(/\s+$/,"");return f="<"+p+">"+f+"</"+p+">\n"});else{e=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g;b=b.replace(e,function(f,l,p,w){f=p;w=w.search(/[*+-]/g)>-1?"ul":"ol";
f=f.replace(/\n{2,}/g,"\n\n\n");f=h(f);return f=l+"<"+w+">\n"+f+"</"+w+">\n"})}return b=b.replace(/~0/,"")};h=function(b){E++;b=b.replace(/\n{2,}$/,"\n");b+="~0";b=b.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(e,f,l,p,w){e=w;if(f||e.search(/\n{2,}/)>-1)e=z(o(e));else{e=d(o(e));e=e.replace(/\n$/,"");e=B(e)}return"<li>"+e+"</li>\n"});b=b.replace(/~0/g,"");E--;return b};var a=function(b){b+="~0";b=b.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,
function(e,f,l){e=f;e=k(o(e));e=x(e);e=e.replace(/^\n+/g,"");e=e.replace(/\n+$/g,"");e="<pre><code>"+e+"\n</code></pre>";return g(e)+l});return b=b.replace(/~0/,"")},g=function(b){b=b.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(D.push(b)-1)+"K\n\n"},n=function(b){return b=b.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,f,l,p){e=p;e=e.replace(/^([ \t]*)/g,"");e=e.replace(/[ \t]*$/g,"");e=k(e);return f+"<code>"+e+"</code>"})},k=function(b){b=b.replace(/&/g,"&amp;");b=b.replace(/</g,"&lt;");
b=b.replace(/>/g,"&gt;");return b=i(b,"*_{}[]\\",false)},m=function(b){return b=b.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,f){var l=f;l=l.replace(/^[ \t]*>[ \t]?/gm,"~0");l=l.replace(/~0/g,"");l=l.replace(/^[ \t]+$/gm,"");l=z(l);l=l.replace(/(^|\n)/g,"$1  ");l=l.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(p,w){var G=w;G=G.replace(/^  /mg,"~0");return G=G.replace(/~0/g,"")});return g("<blockquote>\n"+l+"\n</blockquote>")})},q=function(b){b=b.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,
"&amp;");return b=b.replace(/<(?![a-z\/?\$!])/gi,"&lt;")},r=function(b){b=b.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>');return b=b.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(e,f){return u(s(f))})},u=function(b){var e=[function(f){return"&#"+f.charCodeAt(0)+";"},function(f){f=f.charCodeAt(0);return"&#x"+("0123456789ABCDEF".charAt(f>>4)+"0123456789ABCDEF".charAt(f&15))+";"},function(f){return f}];b="mailto:"+b;b=b.replace(/./g,function(f){if(f==
"@")f=e[Math.floor(Math.random()*2)](f);else if(f!=":"){var l=Math.random();f=l>0.9?e[2](f):l>0.45?e[1](f):e[0](f)}return f});b='<a href="'+b+'">'+b+"</a>";return b=b.replace(/">.+:/g,'">')},s=function(b){return b=b.replace(/~E(\d+)E/g,function(e,f){var l=parseInt(f);return String.fromCharCode(l)})},o=function(b){b=b.replace(/^(\t|[ ]{1,4})/gm,"~0");return b=b.replace(/~0/g,"")},x=function(b){b=b.replace(/\t(?=\t)/g,"    ");b=b.replace(/\t/g,"~A~B");b=b.replace(/~B(.+?)~A/g,function(e,f){for(var l=
f,p=4-l.length%4,w=0;w<p;w++)l+=" ";return l});b=b.replace(/~A/g,"    ");return b=b.replace(/~B/g,"")},i=function(b,e,f){e="(["+e.replace(/([\[\]\\])/g,"\\$1")+"])";if(f)e="\\\\"+e;return b=b.replace(RegExp(e,"g"),v)},v=function(b,e){return"~E"+e.charCodeAt(0)+"E"}};